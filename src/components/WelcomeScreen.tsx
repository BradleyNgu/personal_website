import React, { useEffect, useRef, useState } from "react";

const asciiArt = `

:--===---------::::--:----:-----::::::::::..-===--:::::::...:::::::::::::::::::....:----:::-----:..:
:===-::::----:::-::::::------------::::::::-+=::.:::----::::::::::::::::::-::::...:--:--::::---:...:
==---:..:---:::--::--:::::::::-------::::-+=----::::..::::::--:--:::::::::::---:..:--:------:..:::.:
-::--:::::------:::-------:::::::::--::=======-----::.::--::--:::::::::::::::::.:---------:::::..:::
...:-::--------:::-:---------::-:::------=+=====+===-::---::::::------:::::::--------::::::::::....:
-----::-----------::---:::::----:::=+=-=++++++==+++==----------------::::-------:::--:::-::::......:
------::::::-:::----=-----:---::--:---+**#######*+*++++++++====--------::::::::::::--::::.....:::::-
----------::::----==-:---------=-----+##%%##%%%#%%#*#########*+==-----::::::::-------::::::::::..:-=
-------=--::::--===+=----::--===--=++#%%#%%%%@@%%%%%%%%%#######**+------::::::::--:::::::::::::...:-
::::---::-=--------------===-----+**#%%%%%%%%@@@@@%%%@@@@%%%%%%#**++-::----::::--::::::::::::::::::-
::::::::::-====--------------::-+####%%@%%%%%%%%%%%%#%%%%@@@@@%%#**++=::::::::::::::::::::::::::::::
------:-::--===-----------::::-=####%%@@%%######*********#%%%@%%%#**+==:.:::-::::::::::-::---:----::
--=--::::.:--:--------==------+#%%#%%@@%%%###**++++==++++**#%%%%%####++::::::::::---::-------:---:::
:::--::::::--::::-=****+===-=*#%%%%%%@%%###**++++====+==++**##%%%%####*+-:::::::---------:::::------
::::--::------=+**++=-::::-=+%%%%%%%%%%%###**++++=====+++++**##%%%%%%##*+--:-:::-:::..:::::::::::--:
-::------=+***+=-::::::::-==%%%%%%%@%%%###**+++=======+++++**###%%%%%%%#*-::::-:::::.....::--:::::::
-===-::-+**+--:::::---:-===+%#%%%%@@%####**++++=======++++++**##%%%%%%%%#--::::::::::::::::---=-::::
:::::-+**+-:::::::::-===---*%%%%@@@%%###**++++=======++++++++*###%%@%%%%%=---::::::::::::::::::-:::-
----=**=-::.::::---==-:..::#@@%%@@%%########**+++++++**#######%%%%@@@@@%%#-:::::::::::::::::::--::::
+***=::::::::-==++-::::::::-#@@@@%%####%#%%%%##**++**######*####%%@@@@@@@%-::::::::::::::::::::::::-
+=----::--=+++=-:::-::::::.:*%@@%%###******#####*++***#****###*##%@@@@@@@%+-::::::::::::::::::::::--
-::-==++++==-:::::::::::::::=@@%%#+***#%#%%%###*++++*####%%%%%###%%@@@@@@**::::::::::::::::::::::::-
==++*+=-:---:::::::::::::::::#%%#==+*++***###***+==+*************##@@@@@%#+::::::::-:::::::::::::::-
++=-:-----------:::::::::::::=*#*-====++****+++=====++++*****+++++*%@@%%#*-:::-----------::::::::::-
::::::::::---:::--:::::::::::-=*=----======++==----===+++++=====+++*%%@*=:::--::-------=--:::::::---
:::----::::::::::::::::::::::-=++------=====+==--=====++*+++===+=+++*#*-:::-==--:----::-------::::.:
----:-::::::::::::::::--::::::-==----===++**+-===+++++++****++++++==+==--------:::-:-::::--:::::::::
:::::::::::::----:::::::--:::::--=-==+++*****+*#****###********+++===-::-:--::-===-:::-----::::::::-
::.::::::::::::--:::::::::--::::--==++*#***+++****#*********#***++=-::::::::-:--=+=----:--::::::::::
::.:::::----:.:---::::--:::--::::-==+******++++++++***+++*******++=--:::::----===++===--:---------=+
.:::::------::::::::-:---:::::::::-==++**####***********#%#***++++=-=-:-----=====++++====--=+=+=---+
::::----:-::-==::-::::-----::::::::==+++***##++======++*#***++++++**#**++**++**++*++++++++++*+=----=
::::---:::::--====++-:---::--::::---==++++++++++++++****++++++**+*%%%%%%%%%#******+++++++++**+=+-:--
::------:::::::-++++=-=----::::-::--====++====+********++++++***+%@%%%%##*########*+====++*##*-:::-=
::--:::::--------+**++---:::::-----=**+=======+++*****+++++++***+%%@%###%%%%%%%##%#=::----===-:.:::-
:::::::-------===+**+=-::::-++*+*****#@%===--===++++++++==+++***+#%%%%%%%%%%%%%%%*%+:--====+-:::-::-
::-=++====+++++******+==++=*#*-:+###%@@@+==========+====+++*****%%%%%%%%%%%%%%%%%%#=-=====---==+=---
==+*%#****########*+***++++##*+*%#%@@@@@#=====++++**++++*****#%%%%%%%%%%%%%%%%%%%%%*-:::::::-==++=--
#***##**#####%%%##*++**++=*###%@%%%@@@@@@====+*******####**#%@@@%%%%%%%%%%%%%%######*-.::::::-=+==-=
**+***#***#%%####*++***+++###%@%%@@@@@@@@*===+**######****#%@@@@@%%%%%%%%%%%%########*-::::::-----==
*=---=##**#%%#**#**+****+=+*#@@#%@@@@@@@@*===++*********#%@@@@%%%%%%%%%%%%%%%#######***-:::::---:--=
+=====##***###**+====---::-*#%%%%@@@@@@@@#====++*******#%%@@%%%%%%%%%%%%%%%%########***+----::-::---
+=====*#+==------:::::::..-*#%%%%@@@@@@@@#+===+++*******%%%%@%%%%%%%%%%%%%%%%%%%%%%%%%%%#=::::::::::
=+*****=::::::::::::::::..-*#%%%%%@@@@@@%#++=++++**++*##*%%%%%%%%%%%%%%%%%%%%@@%%%%%%%#%%*:::......:
-++**+=::::::::-:::::::.:-+*##%%%%%%@@@@%**+++++++**#%%%%%%%%%%%%%%%%%%%@@@%%%%%####%%%%#=.......:::
-==++=-::::::--=-:::::-=****###%%%%%%@@@#*++++++++*##%%%%%%%%%%%%%%%@@@@%%%%%%#%%%@@@%#**+==+=-:::::
----==----:::-==-:::-+##*#%###%%%%%%%%%%*++====++*###%%%%%%%%%%%%@@@%%%%%%%%@@@@@%%%%%****+++++**+--
-----=:::::::::::::+*###%#%%%#*#%%##%%%%*=======*####%%%%%%%%%@@@%%%%%%%@@@@@@%%%%%%##%%%##****==***
------:::::::::::=*#%%%%##%%%%#%%%%%%%%%%#=-===*###%%%%%%%%@@@@@%%@@@@@%%%%%%%#%%###%#%%@@@%%#######
------:::::::::-+*##%%%%%%%%%%%%@@%%%%%%%%%%#+###%%#%%%%%@@@@@%%##%%%%%%%%#%##%%######%%%%%%%%#%%%##
--------::::::-+####%%%%%%%##%#%@@@%@@@@@@@@%#*##%%#%@@@@@@@%%###%%%%%%%##%##%#####%#**######%%%#%##
---::::-------+####%%%%######%%@@@@%%%%%@@%%######%#%@@@@@@%###%@@%%%%%%#%%#%#######%@%%#%%%%%%%%##%
:-:----------+####%%%%######%@#@@@@%%%%%%%##%%#%@@%%@@@@@%###%@@@@%%%%%#%%#%%######%%%#%%%%##%%##%%%
----------::=#%##%%%%######%%@%@@%%%%%%%%###%##%@@%%@@@@%###%@@@@%%%%%##%%%%######%%#######%%%##%%%%
------------#%%%%%%#######%%@%%%%%%%%%%%###%%#%@@@%%@@@%##%@@@@@%%%%%###%%%######%%#######%%%##%%%%%










██╗    ██╗███████╗██╗      ██████╗ ██████╗ ███╗   ███╗███████╗                                      
██║    ██║██╔════╝██║     ██╔════╝██╔═══██╗████╗ ████║██╔════╝                                      
██║ █╗ ██║█████╗  ██║     ██║     ██║   ██║██╔████╔██║█████╗                                        
██║███╗██║██╔══╝  ██║     ██║     ██║   ██║██║╚██╔╝██║██╔══╝                                        
╚███╔███╔╝███████╗███████╗╚██████╗╚██████╔╝██║ ╚═╝ ██║███████╗                                      
 ╚══╝╚══╝ ╚══════╝╚══════╝ ╚═════╝ ╚═════╝ ╚═╝     ╚═╝╚══════╝       
                                                                                                    
████████╗ ██████╗     ███╗   ███╗██╗   ██╗    ██╗    ██╗███████╗██████╗ ███████╗██╗████████╗███████╗
╚══██╔══╝██╔═══██╗    ████╗ ████║╚██╗ ██╔╝    ██║    ██║██╔════╝██╔══██╗██╔════╝██║╚══██╔══╝██╔════╝
   ██║   ██║   ██║    ██╔████╔██║ ╚████╔╝     ██║ █╗ ██║█████╗  ██████╔╝███████╗██║   ██║   █████╗  
   ██║   ██║   ██║    ██║╚██╔╝██║  ╚██╔╝      ██║███╗██║██╔══╝  ██╔══██╗╚════██║██║   ██║   ██╔══╝  
   ██║   ╚██████╔╝    ██║ ╚═╝ ██║   ██║       ╚███╔███╔╝███████╗██████╔╝███████║██║   ██║   ███████╗
   ╚═╝    ╚═════╝     ╚═╝     ╚═╝   ╚═╝        ╚══╝╚══╝ ╚══════╝╚═════╝ ╚══════╝╚═╝   ╚═╝   ╚══════╝ 
   
   
`;

interface WelcomeScreenProps {
  onComplete: () => void;
}

const WelcomeScreen: React.FC<WelcomeScreenProps> = ({ onComplete }) => {
  const [lines, setLines] = useState<string[]>([]);
  const [progress, setProgress] = useState(0);
  const [fontSize, setFontSize] = useState("8px");

  useEffect(() => {
    let index = 0;
    const asciiLines = asciiArt.trim().split("\n").map((line) => line.trimEnd());

    const interval = setInterval(() => {
      if (index < asciiLines.length) {
        setLines((prevLines) => [...prevLines, asciiLines[index]]);
        index++;
        setProgress((prev) => Math.min(prev + (100 / asciiLines.length), 100));
      } else {
        clearInterval(interval);
        setTimeout(onComplete, 1500);
      }
    }, 40);

    return () => clearInterval(interval);
  }, [onComplete]);

  // Function to adjust font size dynamically
  useEffect(() => {
    const adjustFontSize = () => {
      const screenWidth = window.innerWidth;
      const screenHeight = window.innerHeight;

      // Get ASCII art dimensions
      const numLines = asciiArt.trim().split("\n").length;
      const maxLineLength = Math.max(...asciiArt.split("\n").map((line) => line.length));

      // Compute the smallest necessary font size
      const maxFontSizeW = (screenWidth / maxLineLength) * 0.9; // Reduce width-based scaling
      const maxFontSizeH = (screenHeight / numLines) * 0.85; // Reduce height-based scaling

      // Choose the smallest value to fit everything on screen
      const optimalFontSize = Math.min(maxFontSizeW, maxFontSizeH, 12); // Cap at 12px for readability

      setFontSize(`${Math.max(optimalFontSize, 4)}px`); // Ensure a minimum font size of 4px
    };

    // Adjust font size on mount and window resize
    adjustFontSize();
    window.addEventListener("resize", adjustFontSize);

    return () => window.removeEventListener("resize", adjustFontSize);
  }, []);

  // Dynamically adjust progress bar length based on screen width
  const progressBar = () => {
    const screenWidth = window.innerWidth;
    const totalLength = Math.max(25, Math.min(40, Math.floor(screenWidth / 25))); // Scale progress bar
    const filledLength = Math.round((progress / 100) * totalLength);
    const emptyLength = totalLength - filledLength;
    return `+${"#".repeat(filledLength)}${" ".repeat(emptyLength)}+`;
  };

  return (
    <div
      className="ascii-terminal"
      style={{
        width: "100vw",
        height: "100vh",
        display: "flex",
        flexDirection: "column",
        justifyContent: "center",
        alignItems: "center",
        textAlign: "center",
        backgroundColor: "black",
        color: "white",
        position: "relative",
        overflow: "hidden",
      }}
    >
      <div
        style={{
          maxWidth: "95vw", // More compact layout
          maxHeight: "95vh",
          overflow: "hidden",
          whiteSpace: "pre-wrap",
          fontFamily: "monospace",
          fontSize: fontSize, // Dynamically set font size
          lineHeight: "1",
          textAlign: "left",
          padding: "5px",
        }}
      >
        {lines.map((line, i) => (
          <pre key={i} style={{ margin: 0 }}>{line}</pre>
        ))}
      </div>

      {/* Progress Bar - Always visible and scaled */}
      <div
        style={{
          position: "absolute",
          bottom: "2vh",
          left: "50%",
          transform: "translateX(-50%)",
          textAlign: "center",
          color: "white",
          fontFamily: "monospace",
          fontSize: "clamp(6px, 1vw, 12px)", // Ensures visibility
          whiteSpace: "nowrap",
          width: "90vw",
        }}
      >
        <pre style={{ margin: 0 }}>{progressBar()}</pre>
      </div>
    </div>
  );
};

export default WelcomeScreen;